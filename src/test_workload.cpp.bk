#include <cassert>
#include <cstdlib>
#include <ctime>
#include "util.h"
#include "tandemIndex.h"

void exec(int num_thread) {
    double start_build_time = 0;
    double end_build_time = 0;
    double build_time = 0;
    start_build_time = get_now();
    TandemIndex idx;
    end_build_time = get_now();
    build_time = end_build_time - start_build_time;
    double start_time = 0;
    double end_time = 0;
    double elapsed_time = 0;
    int num_insert = 500000;
    auto func = [&idx, num_insert](int thread_id) {
        int start_idx = thread_id * num_insert;
        int end_idx = start_idx + num_insert;
        for(int i = start_idx; i < end_idx; i++) {
            Val_t random_value = std::rand() % 1000 + 1;
            idx.insert(random_value, random_value);
#if 0
            auto ret = idx.lookup(random_value);
            if(ret != random_value) {
                std::cout << "Failed to insert " << random_value <<" got " << ret << std::endl;
                assert(false);
            }
#endif
        }    
    };
    start_time = get_now();
    //startThreads(&idx, num_thread, func);
    end_time = get_now();
    elapsed_time = end_time - start_time;
    std::cout << "Elapsed time: " << elapsed_time <<" Build time: "<< build_time << std::endl;
    return;
}
#if 0
int main() {
    int num_thread = 1;
    exec(num_thread);
    // Lookup nodes

    //list.remove(10);
    //list.remove(20);

    return 0;

}
#endif


